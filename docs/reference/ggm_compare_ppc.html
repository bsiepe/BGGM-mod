<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>GGM Compare: Posterior Predictive Check — ggm_compare_ppc • BGGMmod</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="GGM Compare: Posterior Predictive Check — ggm_compare_ppc" />
<meta property="og:description" content="Compare GGMs with a posterior predicitve check (Gelman et al. 1996)
.
This method was introduced in Williams et al. (2020)
. Currently,
there is a global (the entire GGM) and a nodewise test. The default
is to compare GGMs with respect to the posterior predictive distribution of Kullback
Leibler divergence and the sum of squared errors. It is also possible to compare the
GGMs with a user defined test-statistic." />
<meta property="og:image" content="https://donaldrwilliams.github.io/BGGMmod/reference/figures/hex.jpg" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@wdonald_1985" />
<meta name="twitter:site" content="@wdonald_1985" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BGGMmod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/installation.html">Troubleshoot</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/donaldRwilliams/BGGMmod/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>GGM Compare: Posterior Predictive Check</h1>
    <small class="dont-index">Source: <a href='https://github.com/donaldRwilliams/BGGMmod/blob/master/R/ggm_compare_ppc.default.R'><code>R/ggm_compare_ppc.default.R</code></a></small>
    <div class="hidden name"><code>ggm_compare_ppc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compare GGMs with a posterior predicitve check (Gelman et al. 1996)
.
This method was introduced in Williams et al. (2020)
. Currently,
there is a <code>global</code> (the entire GGM) and a <code>nodewise</code> test. The default
is to compare GGMs with respect to the posterior predictive distribution of Kullback
Leibler divergence and the sum of squared errors. It is also possible to compare the
GGMs with a user defined test-statistic.</p>
    </div>

    <pre class="usage"><span class='fu'>ggm_compare_ppc</span>(
  <span class='no'>...</span>,
  <span class='kw'>test</span> <span class='kw'>=</span> <span class='st'>"global"</span>,
  <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>5000</span>,
  <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>custom_obs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>loss</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>At least two matrices (or data frames) of dimensions <em>n</em> (observations) by  <em>p</em> (variables).</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>Which test should be performed (defaults to <code>"global"</code>) ? The options include
<code>global</code> and <code>nodewise</code>.</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>Number of replicated datasets used to construct the predictivie distribution
(defaults to 5000).</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>An optional function for comparing GGMs that returns a number. See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>custom_obs</th>
      <td><p>Number corresponding to the observed score for comparing the GGMs. This is
required if a function is provided in <code>FUN</code>. See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>loss</th>
      <td><p>Logical. If a function is provided, is the measure a "loss function"
(i.e., a large score is bad thing). This determines how the <em>p</em>-value
is computed. See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>Logical. Should a progress bar be included (defaults to <code>TRUE</code>) ?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The returned object of class <code>ggm_compare_ppc</code> contains a lot of information that
        is used for printing and plotting the results. For users of <strong>BGGMmod</strong>, the following
        are the useful objects:</p>
<p><code>test = "global"</code></p>
<ul>
<li><p><code>ppp_jsd</code> posterior predictive <em>p</em>-values (JSD).</p></li>
<li><p><code>ppp_sse</code> posterior predictive <em>p</em>-values (SSE).</p></li>
<li><p><code>predictive_jsd</code> list containing the posterior predictive distributions (JSD).</p></li>
<li><p><code>predictive_sse</code> list containing the posterior predictive distributions (SSE).</p></li>
<li><p><code>obs_jsd</code> list containing the observed error (JSD).</p></li>
<li><p><code>obs_sse</code> list containing the observed error (SSE).</p></li>
</ul>


<p><code>test = "nodewise"</code></p>
<ul>
<li><p><code>ppp_jsd</code> posterior predictive <em>p</em>-values (JSD).</p></li>
<li><p><code>predictive_jsd</code> list containing the posterior predictive distributions (JSD).</p></li>
<li><p><code>obs_jsd</code> list containing the observed error (JSD).</p></li>
</ul>

<p><code>FUN = f()</code></p>
<ul>
<li><p><code>ppp_custom</code> posterior predictive <em>p</em>-values (custom).</p></li>
<li><p><code>predictive_custom</code> posterior predictive distributions (custom).</p></li>
<li><p><code>obs_custom</code> observed error (custom).</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>FUN</code> argument allows for a user defined test-statisic (the measure used to compare the GGMs).
The function must include only two agruments, each of which corresponds to a dataset. For example,
<code>f &lt;- function(Yg1, Yg2)</code>, where each Y is dataset of dimensions <em>n</em> by <em>p</em>. The
groups are then compare within the function, returning a single number. An example is provided below.</p>
<p>Further, when using a custom function care must be taken when specifying the argument <code>loss</code>.
We recommended to visualize the results with <code>plot</code> to ensure the <em>p</em>-value was computed
in the right direction.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><strong>Interpretation</strong>:</p>
<p>The primary test-statistic is symmetric KL-divergence that is termed Jensen-Shannon divergence (JSD).
This is in essence a likelihood ratio that provides the "distance" between two multivariate normal
distributions. The basic idea is to (1) compute the posterior predictive distribution, assuming group equality
(the null model). This provides the error that we would expect to see under the null model; (2) compute
JSD for the observed groups; and (3) compare the observed JSD to the posterior predictive distribution,
from which a posterior predictive <em>p</em>-value is computed.</p>
<p>For the <code>global</code> check, the sum of squared error is also provided.
This is computed from the partial correlation matrices and it is analagous
to the strength test in van
Borkulo et al. (2017)
. The <code>nodewise</code>
test compares the posterior predictive distribution for each node. This is based on the correspondence
between the inverse covariance matrix and multiple regresssion (Kwan 2014; Stephens 1998)
.</p>
<p>If the null model is <code>not</code> rejected, note that this does <code>not</code> provide evidence for equality!
Further, if the null model is rejected, this means that the assumption of group equality is not tenable--the
groups are different.</p>
<p><strong>Alternative Methods</strong>:</p>
<p>There are several methods in <strong>BGGMmod</strong> for comparing groups. See
<code><a href='ggm_compare_estimate.html'>ggm_compare_estimate</a></code> (posterior differences for the
partial correlations), <code><a href='ggm_compare_explore.html'>ggm_compare_explore</a></code> (exploratory hypothesis testing),
and <code><a href='ggm_compare_confirm.html'>ggm_compare_confirm</a></code> (confirmatory hypothesis testing).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gelman A, Meng X, Stern H (1996).
&#8220;Posterior predictive assessment of model fitness via realized discrepancies.&#8221;
<em>Statistica sinica</em>, 733--760.<br /><br /> Kwan CC (2014).
&#8220;A regression-based interpretation of the inverse of the sample covariance matrix.&#8221;
<em>Spreadsheets in Education</em>, <b>7</b>(1), 4613.<br /><br /> Stephens G (1998).
&#8220;On the Inverse of the Covariance Matrix in Portfolio Analysis.&#8221;
<em>The Journal of Finance</em>, <b>53</b>(5), 1821--1827.<br /><br /> van
Borkulo CD, Boschloo L, Kossakowski J, Tio P, Schoevers RA, Borsboom D, Waldorp LJ (2017).
&#8220;Comparing network structures on three aspects: A permutation test.&#8221;
<em>Manuscript submitted for publication</em>.<br /><br /> Williams DR, Rast P, Pericchi LR, Mulder J (2020).
&#8220;Comparing Gaussian graphical models with the posterior predictive distribution and Bayesian model selection.&#8221;
<em>Psychological Methods</em>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>
<span class='co'># note: iter = 250 for demonstrative purposes</span>

<span class='co'># data</span>
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='no'>bfi</span>

<span class='co'>#############################</span>
<span class='co'>######### global ############</span>
<span class='co'>#############################</span>


<span class='co'># males</span>
<span class='no'>Ym</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>Y</span>, <span class='no'>gender</span> <span class='kw'>==</span> <span class='fl'>1</span>,
             <span class='kw'>select</span> <span class='kw'>=</span> - <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>gender</span>, <span class='no'>education</span>))

<span class='co'># females</span>

<span class='no'>Yf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>Y</span>, <span class='no'>gender</span> <span class='kw'>==</span> <span class='fl'>2</span>,
             <span class='kw'>select</span> <span class='kw'>=</span> - <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>gender</span>, <span class='no'>education</span>))


<span class='no'>global_test</span> <span class='kw'>&lt;-</span> <span class='fu'>ggm_compare_ppc</span>(<span class='no'>Ym</span>, <span class='no'>Yf</span>,
                               <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>250</span>)</div><div class='output co'>#&gt; <span class='message'>BGGMmod: Predictive Check (Contrast 1)</span></div><div class='output co'>#&gt; <span class='message'>BGGMmod: Finished</span></div><div class='input'>
<span class='no'>global_test</span></div><div class='output co'>#&gt; BGGMmod: Bayesian Gaussian Graphical Models 
#&gt; --- 
#&gt; Test: Global Predictive Check 
#&gt; Posterior Samples: 250 
#&gt;   Group 1: 805 
#&gt;   Group 2: 1631 
#&gt; Nodes:  25 
#&gt; Relations: 300 
#&gt; --- 
#&gt; Call: 
#&gt; ggm_compare_ppc(Ym, Yf, iter = 250)
#&gt; --- 
#&gt; Symmetric KL divergence (JSD): 
#&gt;  
#&gt;    contrast JSD.obs p_value
#&gt;  Yg1 vs Yg2   0.442       0
#&gt; --- 
#&gt;  
#&gt; Sum of Squared Error: 
#&gt;  
#&gt;    contrast SSE.obs p.value
#&gt;  Yg1 vs Yg2   0.759       0
#&gt; --- 
#&gt; note:
#&gt; JSD is Jensen-Shannon divergence </div><div class='input'>

<span class='co'>#############################</span>
<span class='co'>###### custom function ######</span>
<span class='co'>#############################</span>
<span class='co'># example 1</span>

<span class='co'># maximum difference van Borkulo et al. (2017)</span>

<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>Yg1</span>, <span class='no'>Yg2</span>){

<span class='co'># remove NA</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span>(<span class='no'>Yg1</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span>(<span class='no'>Yg2</span>)

<span class='co'># nodes</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>Yg1</span>)

<span class='co'># identity matrix</span>
<span class='no'>I_p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>p</span>)

<span class='co'># partial correlations</span>

<span class='no'>pcor_1</span> <span class='kw'>&lt;-</span> -(<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov2cor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>(<span class='no'>x</span>))) - <span class='no'>I_p</span>)
<span class='no'>pcor_2</span> <span class='kw'>&lt;-</span> -(<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov2cor</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>(<span class='no'>y</span>))) - <span class='no'>I_p</span>)

<span class='co'># max difference</span>
<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>((<span class='no'>pcor_1</span>[<span class='fu'><a href='https://rdrr.io/r/base/lower.tri.html'>upper.tri</a></span>(<span class='no'>I_p</span>)] - <span class='no'>pcor_2</span>[<span class='fu'><a href='https://rdrr.io/r/base/lower.tri.html'>upper.tri</a></span>(<span class='no'>I_p</span>)])))

}

<span class='co'># observed difference</span>
<span class='no'>obs</span> <span class='kw'>&lt;-</span> <span class='fu'>f</span>(<span class='no'>Ym</span>, <span class='no'>Yf</span>)

<span class='no'>global_max</span> <span class='kw'>&lt;-</span> <span class='fu'>ggm_compare_ppc</span>(<span class='no'>Ym</span>, <span class='no'>Yf</span>,
                              <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>250</span>,
                              <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>f</span>,
                              <span class='kw'>custom_obs</span> <span class='kw'>=</span> <span class='no'>obs</span>,
                              <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='no'>global_max</span></div><div class='output co'>#&gt; BGGMmod: Bayesian Gaussian Graphical Models 
#&gt; --- 
#&gt; Test: Global Predictive Check 
#&gt; Posterior Samples: 250 
#&gt;   Group 1: 805 
#&gt;   Group 2: 1631 
#&gt; Nodes:  25 
#&gt; Relations: 300 
#&gt; --- 
#&gt; Call: 
#&gt; ggm_compare_ppc(Ym, Yf, iter = 250, FUN = f, custom_obs = obs, 
#&gt;     progress = FALSE)
#&gt; --- 
#&gt; Custom: 
#&gt;  
#&gt;    contrast custom.obs p.value
#&gt;  Yg1 vs Yg2       0.16   0.056
#&gt; --- </div><div class='input'>

<span class='co'># example 2</span>
<span class='co'># Hamming distance (squared error for adjacency)</span>

<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>Yg1</span>, <span class='no'>Yg2</span>){

<span class='co'># remove NA</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span>(<span class='no'>Yg1</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span>(<span class='no'>Yg2</span>)

<span class='co'># nodes</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>x</span>)

<span class='co'># identity matrix</span>
<span class='no'>I_p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>p</span>)

<span class='no'>fit1</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='estimate.html'>estimate</a></span>(<span class='no'>x</span>, <span class='kw'>analytic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>fit2</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='estimate.html'>estimate</a></span>(<span class='no'>y</span>, <span class='kw'>analytic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='no'>sel1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='select.html'>select</a></span>(<span class='no'>fit1</span>)
<span class='no'>sel2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='select.html'>select</a></span>(<span class='no'>fit2</span>)

<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>((<span class='no'>sel1</span>$<span class='no'>adj</span>[<span class='fu'><a href='https://rdrr.io/r/base/lower.tri.html'>upper.tri</a></span>(<span class='no'>I_p</span>)] - <span class='no'>sel2</span>$<span class='no'>adj</span>[<span class='fu'><a href='https://rdrr.io/r/base/lower.tri.html'>upper.tri</a></span>(<span class='no'>I_p</span>)])^<span class='fl'>2</span>)

}

<span class='co'># observed difference</span>
<span class='no'>obs</span> <span class='kw'>&lt;-</span> <span class='fu'>f</span>(<span class='no'>Ym</span>, <span class='no'>Yf</span>)

<span class='no'>global_hd</span> <span class='kw'>&lt;-</span> <span class='fu'>ggm_compare_ppc</span>(<span class='no'>Ym</span>, <span class='no'>Yf</span>,
                            <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>250</span>,
                            <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>f</span>,
                            <span class='kw'>custom_obs</span>  <span class='kw'>=</span> <span class='no'>obs</span>,
                            <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='no'>global_hd</span></div><div class='output co'>#&gt; BGGMmod: Bayesian Gaussian Graphical Models 
#&gt; --- 
#&gt; Test: Global Predictive Check 
#&gt; Posterior Samples: 250 
#&gt;   Group 1: 805 
#&gt;   Group 2: 1631 
#&gt; Nodes:  25 
#&gt; Relations: 300 
#&gt; --- 
#&gt; Call: 
#&gt; ggm_compare_ppc(Ym, Yf, iter = 250, FUN = f, custom_obs = obs, 
#&gt;     progress = FALSE)
#&gt; --- 
#&gt; Custom: 
#&gt;  
#&gt;    contrast custom.obs p.value
#&gt;  Yg1 vs Yg2         75    0.52
#&gt; --- </div><div class='input'>

<span class='co'>#############################</span>
<span class='co'>########  nodewise ##########</span>
<span class='co'>#############################</span>

<span class='no'>nodewise</span> <span class='kw'>&lt;-</span> <span class='fu'>ggm_compare_ppc</span>(<span class='no'>Ym</span>, <span class='no'>Yf</span>, <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>250</span>,
                           <span class='kw'>test</span> <span class='kw'>=</span> <span class='st'>"nodewise"</span>)</div><div class='output co'>#&gt; <span class='message'>BGGMmod: Predictive Check (Contrast 1)</span></div><div class='output co'>#&gt; <span class='message'>BGGMmod: Finished</span></div><div class='input'>
<span class='no'>nodewise</span></div><div class='output co'>#&gt; BGGMmod: Bayesian Gaussian Graphical Models 
#&gt; --- 
#&gt; Test: Nodewise Predictive Check 
#&gt; Posterior Samples: 250 
#&gt;   Group 1: 805 
#&gt;   Group 2: 1631 
#&gt; Nodes:  25 
#&gt; Relations: 300 
#&gt; --- 
#&gt; Call: 
#&gt; ggm_compare_ppc(Ym, Yf, test = "nodewise", iter = 250)
#&gt; --- 
#&gt; Symmetric KL divergence (JSD): 
#&gt;  
#&gt; Yg1 vs Yg2 
#&gt;  Node JSD.obs p_value
#&gt;     1   0.001   0.628
#&gt;     2   0.000   0.964
#&gt;     3   0.006   0.076
#&gt;     4   0.005   0.200
#&gt;     5   0.006   0.084
#&gt;     6   0.002   0.464
#&gt;     7   0.000   0.728
#&gt;     8   0.000   0.844
#&gt;     9   0.000   0.920
#&gt;    10   0.003   0.228
#&gt;    11   0.020   0.012
#&gt;    12   0.009   0.004
#&gt;    13   0.003   0.304
#&gt;    14   0.004   0.080
#&gt;    15   0.011   0.024
#&gt;    16   0.001   0.504
#&gt;    17   0.000   0.692
#&gt;    18   0.000   0.624
#&gt;    19   0.000   0.736
#&gt;    20   0.000   0.708
#&gt;    21   0.000   0.896
#&gt;    22   0.003   0.472
#&gt;    23   0.002   0.380
#&gt;    24   0.013   0.212
#&gt;    25   0.018   0.032
#&gt; --- 
#&gt; 
#&gt; note:
#&gt; JSD is Jensen-Shannon divergence </div><div class='input'>
# }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Donald Williams, Joris Mulder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


