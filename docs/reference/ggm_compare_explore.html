<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>GGM Compare: Exploratory Hypothesis Testing — ggm_compare_explore • BGGMmod</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="GGM Compare: Exploratory Hypothesis Testing — ggm_compare_explore" />
<meta property="og:description" content="Compare Gaussian graphical models with exploratory hypothesis testing using the matrix-F prior
distribution (Mulder and Pericchi 2018)
. A test for each partial correlation in the model for any number
of groups. This provides evidence for the null hypothesis of no difference and the alternative hypothesis
of difference. With more than two groups, the test is for all groups simultaneously (i.e., the relation
is the same or different in all groups). This method was introduced in Williams et al. (2020)
.
For confirmatory hypothesis testing see confirm_groups." />
<meta property="og:image" content="https://donaldrwilliams.github.io/BGGMmod/reference/figures/hex.jpg" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@wdonald_1985" />
<meta name="twitter:site" content="@wdonald_1985" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BGGMmod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/installation.html">Troubleshoot</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/donaldRwilliams/BGGMmod/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>GGM Compare: Exploratory Hypothesis Testing</h1>
    <small class="dont-index">Source: <a href='https://github.com/donaldRwilliams/BGGMmod/blob/master/R/ggm_compare_bf.default.R'><code>R/ggm_compare_bf.default.R</code></a></small>
    <div class="hidden name"><code>ggm_compare_explore.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compare Gaussian graphical models with exploratory hypothesis testing using the matrix-F prior
distribution (Mulder and Pericchi 2018)
. A test for each partial correlation in the model for any number
of groups. This provides evidence for the null hypothesis of no difference and the alternative hypothesis
of difference. With more than two groups, the test is for <em>all</em> groups simultaneously (i.e., the relation
is the same or different in all groups). This method was introduced in Williams et al. (2020)
.
For confirmatory hypothesis testing see <code>confirm_groups</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>ggm_compare_explore</span>(
  <span class='no'>...</span>,
  <span class='kw'>formula</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"continuous"</span>,
  <span class='kw'>mixed_type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>analytic</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>prior_sd</span> <span class='kw'>=</span> <span class='fl'>0.2</span>,
  <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>5000</span>,
  <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>1</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>At least two matrices (or data frame) of dimensions <em>n</em> (observations) by  <em>p</em> (variables).</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>An object of class <code><a href='https://rdrr.io/r/stats/formula.html'>formula</a></code>. This allows for including
control variables in the model (i.e., <code>~ gender</code>).</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Character string. Which type of data for <code>Y</code> ? The options include <code>continuous</code>,
<code>binary</code>, or <code>ordinal</code>. See the note for further details.</p></td>
    </tr>
    <tr>
      <th>mixed_type</th>
      <td><p>Numeric vector. An indicator of length p for which varibles should be treated as ranks.
(1 for rank and 0 to assume normality). The default is currently (dev version) to treat all integer variables
as ranks when <code>type = "mixed"</code> and <code>NULL</code> otherwise. See note for further details.</p></td>
    </tr>
    <tr>
      <th>analytic</th>
      <td><p>logical. Should the analytic solution be computed (default is <code>FALSE</code>) ? See note for details.</p></td>
    </tr>
    <tr>
      <th>prior_sd</th>
      <td><p>Numeric. The scale of the prior distribution (centered at zero), in reference to a beta distribtuion.
The `default` is 0.20. See note for further details.</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>number of iterations (posterior samples; defaults to 5000).</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>Logical. Should a progress bar be included (defaults to <code>TRUE</code>) ?</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>An integer for the random seed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The returned object of class <code>ggm_compare_explore</code> contains a lot of information that
        is used for printing and plotting the results. For users of <strong>BGGMmod</strong>, the following
        are the useful objects:</p>
<ul>
<li><p><code>BF_01</code> A <em>p</em> by <em>p</em> matrix including
                    the Bayes factor for the null hypothesis.</p></li>
<li><p><code>pcor_diff</code> A <em>p</em> by <em>p</em> matrix including
                       the difference in partial correlations (only for two groups).</p></li>
<li><p><code>samp</code> A list containing the fitted models (of class <code>explore</code>) for each group.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Controlling for Variables</strong>:</p>
<p>When controlling for variables, it is assumed that <code>Y</code> includes <em>only</em>
the nodes in the GGM and the control variables. Internally, <code>only</code> the predictors
that are included in <code>formula</code> are removed from <code>Y</code>. This is not behavior of, say,
<code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code>, but was adopted to ensure  users do not have to write out each variable that
should be included in the GGM. An example is provided below.</p>
<p><strong>Mixed Type</strong>:</p>
<p>The term "mixed" is somewhat of a misnomer, because the method can be used for data including <em>only</em>
 continuous or <em>only</em> discrete variables. This is based on the ranked likelihood which requires sampling
 the ranks for each variable (i.e., the data is not merely transformed to ranks). This is computationally
 expensive when there are many levels. For example, with continuous data, there are as many ranks
 as data points!</p>
<p>The option <code>mixed_type</code> allows the user to determine  which variable should be treated as ranks
 and the "emprical" distribution is used otherwise. This is accomplished by specifying an indicator
 vector of length <em>p</em>. A one indicates to use the ranks, whereas a zero indicates to "ignore"
 that variable. By default all integer variables are handled as ranks.</p>
<p><strong>Dealing with Errors</strong>:</p>
<p>An error is most likely to arise when <code>type = "ordinal"</code>. The are two common errors (although still rare):</p>
<ul>
<li><p>The first is due to sampling the thresholds, especially when the data is heavily skewed.
      This can result in an ill-defined matrix. If this occurs, we recommend to first try
      decreasing <code>prior_sd</code> (i.e., a more informative prior). If that does not work, then
      change the data type to <code>type = mixed</code> which then estimates a copula GGM
      (this method can be used for data containing <strong>only</strong> ordinal variable). This should
      work without a problem.</p></li>
<li><p>The second is due to how the ordinal data are categorized. For example, if the error states
       that the index is out of bounds, this indicates that the first category is a zero. This is not allowed, as
       the first category must be one. This is addressed by adding one (e.g., <code>Y + 1</code>) to the data matrix.</p></li>
</ul>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><strong>"Default" Prior</strong>:</p>
<p>In Bayesian statistics, a default Bayes factor needs to have several properties. I refer
 interested users to section 2.2 in Dablander et al. (2020)
. In
 Williams and Mulder (2019)
, some of these propteries were investigated, such
 model selection consistency. That said, we would not consider this a "default" Bayes factor and
 thus we encourage users to perform sensitivity analyses by varying the scale of the prior
 distribution.</p>
<p>Furthermore, it is important to note there is no "correct" prior and, also, there is no need
 to entertain the possibility of a "true" model. Rather, the Bayes factor can be interpreted as
 which hypothesis best (relative to each other) predicts the observed data
 (Section 3.2 in Kass and Raftery 1995)
.</p>
<p><strong>Interpretation of Conditional (In)dependence Models for Latent Data</strong>:</p>
<p>See <code><a href='BGGMmod-package.html'>BGGMmod-package</a></code> for details about interpreting GGMs based on latent data
(i.e, all data types besides <code>"continuous"</code>)</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Dablander F, Bergh Dvd, Ly A, Wagenmakers E (2020).
&#8220;Default Bayes Factors for Testing the (In) equality of Several Population Variances.&#8221;
<em>arXiv preprint arXiv:2003.06278</em>.<br /><br /> Kass RE, Raftery AE (1995).
&#8220;Bayes Factors.&#8221;
<em>Journal of the American Statistical Association</em>, <b>90</b>(430), 773--795.<br /><br /> Mulder J, Pericchi L (2018).
&#8220;The Matrix-F Prior for Estimating and Testing Covariance Matrices.&#8221;
<em>Bayesian Analysis</em>, 1--22.
ISSN 19316690, doi: <a href='https://doi.org/10.1214/17-BA1092'>10.1214/17-BA1092</a>
.<br /><br /> Williams DR, Mulder J (2019).
&#8220;Bayesian Hypothesis Testing for Gaussian Graphical Models: Conditional Independence and Order Constraints.&#8221;
<em>PsyArXiv</em>.
doi: <a href='https://doi.org/10.31234/osf.io/ypxd8'>10.31234/osf.io/ypxd8</a>
.<br /><br /> Williams DR, Rast P, Pericchi LR, Mulder J (2020).
&#8220;Comparing Gaussian graphical models with the posterior predictive distribution and Bayesian model selection.&#8221;
<em>Psychological Methods</em>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>
<span class='co'># note: iter = 250 for demonstrative purposes</span>

<span class='co'># data</span>
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='no'>bfi</span>

<span class='co'># males and females</span>
<span class='no'>Ymale</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>Y</span>, <span class='no'>gender</span> <span class='kw'>==</span> <span class='fl'>1</span>,
                   <span class='kw'>select</span> <span class='kw'>=</span> -<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>gender</span>,
                               <span class='no'>education</span>))[,<span class='fl'>1</span>:<span class='fl'>10</span>]

<span class='no'>Yfemale</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='no'>Y</span>, <span class='no'>gender</span> <span class='kw'>==</span> <span class='fl'>2</span>,
                     <span class='kw'>select</span> <span class='kw'>=</span> -<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>gender</span>,
                                 <span class='no'>education</span>))[,<span class='fl'>1</span>:<span class='fl'>10</span>]

<span class='co'>##########################</span>
<span class='co'>### example 1: ordinal ###</span>
<span class='co'>##########################</span>

<span class='co'># fit model</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>ggm_compare_explore</span>(<span class='no'>Ymale</span>,  <span class='no'>Yfemale</span>,
                           <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"ordinal"</span>,
                           <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>250</span>,
                           <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='co'># summary</span>
<span class='no'>summ</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>fit</span>)

<span class='co'># edge set</span>
<span class='no'>E</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='select.html'>select</a></span>(<span class='no'>fit</span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Donald Williams, Joris Mulder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


