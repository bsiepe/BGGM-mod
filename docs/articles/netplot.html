<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network Plots • BGGMmod</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Network Plots">
<meta property="og:description" content="BGGMmod">
<meta property="og:image" content="https://donaldrwilliams.github.io/BGGMmod/reference/figures/hex.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@wdonald_1985">
<meta name="twitter:site" content="@wdonald_1985">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BGGMmod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/installation.html">Troubleshoot</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/donaldRwilliams/BGGMmod/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Network Plots</h1>
                        <h4 class="author">Donny Williams</h4>
            
            <h4 class="date">5/20/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/BGGMmod/blob/master/vignettes/netplot.Rmd"><code>vignettes/netplot.Rmd</code></a></small>
      <div class="hidden name"><code>netplot.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette shows how to make network plots.</p>
<div id="r-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#r-packages" class="anchor"></a>R packages</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># need the developmental version</span>
<span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"remotes"</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"remotes"</span>)
}

<span class="co"># install from github</span>
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"donaldRwilliams/BGGMmod"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">BGGMmod</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cowplot</span>)</pre></body></html></div>
</div>
</div>
<div id="estimate" class="section level1">
<h1 class="hasAnchor">
<a href="#estimate" class="anchor"></a>Estimate</h1>
<p>For the estimate methods, it is currently only possible detect non-zero relations and the others are set to zero (no connection in the graph). In a future release, it will be possible to define a region of equivalence to directly assess null values. Hence, it is important to note those nodes not connected are not necessarily conditionally independent (absence of evidence is not evidence of absence).</p>
<div id="fit-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-model" class="anchor"></a>Fit Model</h2>
<p>In this example, I use the <code>bfi</code> data which consists of 25 variables measureing different aspects of personality.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># data</span>
<span class="no">Y</span> <span class="kw">&lt;-</span> <span class="no">bfi</span>[,<span class="fl">1</span>:<span class="fl">25</span>]

<span class="co"># fit model</span>
<span class="no">fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/estimate.html">estimate</a></span>(<span class="no">Y</span>)</pre></body></html></div>
</div>
<div id="select-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#select-graph" class="anchor"></a>Select Graph</h2>
<p>The next step is to selec the graph or those relations for which the credible excludes zero</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># select the edge set</span>
<span class="no">E</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">fit</span>,
            <span class="kw">cred</span> <span class="kw">=</span> <span class="fl">0.95</span>,
            <span class="kw">alternative</span> <span class="kw">=</span> <span class="st">"two.sided"</span>)</pre></body></html></div>
<p><code>alternative</code> can be changed to, say, <code>"greater"</code> which would then perform a one-sided hypothesis test for postive relations. This is ideal for many applications in psychology, because often <strong>all</strong> relations are expected to be positive. See this <a href="https://donaldrwilliams.github.io/2020/03/29/dealing-with-negative-red-edges-in-psychological-networks-frequentist-edition/">blog</a> for more about this topic.</p>
</div>
<div id="plot-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-graph" class="anchor"></a>Plot Graph</h2>
<p>Here is the basic plot. This works for any object from <code>select</code> (e.g., comparing groups).</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">E</span>)</pre></body></html></div>
<p><img src="../man/figures/netplot_1.png"></p>
<div id="customize-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#customize-plot" class="anchor"></a>Customize Plot</h3>
<p>The above is <code>ggplot</code> that can be futher honed in. Here is an example.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># extract communities</span>
<span class="no">comm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">Y</span>), <span class="fl">1</span>, <span class="fl">1</span>)

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">E</span>,
     <span class="co"># enlarge edges</span>
     <span class="kw">edge_magnify</span> <span class="kw">=</span> <span class="fl">5</span>,
     <span class="co"># cluster nodes</span>
     <span class="kw">groups</span> <span class="kw">=</span> <span class="no">comm</span>,
     <span class="co"># change layout</span>
     <span class="kw">layout</span> <span class="kw">=</span> <span class="st">"circle"</span>)$<span class="no">plt</span> +
  <span class="co"># add custom labels</span>
  <span class="fu">scale_color_brewer</span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>,
                                <span class="st">"C"</span>,
                                <span class="st">"E"</span>,
                                <span class="st">"N"</span>,
                                <span class="st">"O"</span>),
                     <span class="kw">labels</span> <span class="kw">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Agreeableness"</span>, <span class="st">"Conscientiousness"</span>,
                                  <span class="st">"Extraversion"</span>, <span class="st">"Neuroticism"</span>,
                                  <span class="st">"Opennness"</span>),
                     <span class="kw">palette</span> <span class="kw">=</span> <span class="st">"Set2"</span>)</pre></body></html></div>
<p><img src="../man/figures/netplot_2.png"></p>
<p>The <code>edge_magnify</code> is a value that is multiplied by the edges, <code>groups</code> allows for grouping the variables (e.g., those thought to belong to the same “community” will be the same color), and the <code>scale_color_brewer</code> is from the package <code>ggplot2</code> (<code>pallete</code> controls the color of the <code>groups</code>). By default the edge colors are from a color blind palette. This can be changed in <code>plot</code> with the arguments <code>pos_col</code> (the color for positive edges) and <code>pos_neg</code> (the color for negative edges).</p>
<p>This is just scratching the surface of possibilities, as essentially any change can be made to the plot. There is lots of support for making nice plots readily available online.</p>
<div id="layout" class="section level4">
<h4 class="hasAnchor">
<a href="#layout" class="anchor"></a>Layout</h4>
<p>It is also possible to change the layout. This is done with the <strong>sna</strong> package, which is linked in the documentation for <code>plot.select</code> in <strong>BGGMmod</strong>. Here is an example using <code>layout = "random"</code></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">E</span>,
     <span class="co"># enlarge edges</span>
     <span class="kw">edge_magnify</span> <span class="kw">=</span> <span class="fl">5</span>,
     <span class="co"># cluster nodes</span>
     <span class="kw">groups</span> <span class="kw">=</span> <span class="no">comm</span>,
     <span class="co"># change layout</span>
     <span class="kw">layout</span> <span class="kw">=</span> <span class="st">"random"</span>)$<span class="no">plt</span> +
  <span class="co"># add custom labels</span>
  <span class="fu">scale_color_brewer</span>(<span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>,
                                <span class="st">"C"</span>,
                                <span class="st">"E"</span>,
                                <span class="st">"N"</span>,
                                <span class="st">"O"</span>),
                     <span class="kw">labels</span> <span class="kw">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Agreeableness"</span>, <span class="st">"Conscientiousness"</span>,
                                  <span class="st">"Extraversion"</span>, <span class="st">"Neuroticism"</span>,
                                  <span class="st">"Opennness"</span>),
                     <span class="kw">palette</span> <span class="kw">=</span> <span class="st">"Set2"</span>)</pre></body></html></div>
<p><img src="../man/figures/netplot_3.png"></p>
</div>
</div>
</div>
</div>
<div id="bayesian-hypothesis-testing" class="section level1">
<h1 class="hasAnchor">
<a href="#bayesian-hypothesis-testing" class="anchor"></a>Bayesian Hypothesis Testing</h1>
<p>The Bayesian hypothesis testing methods offer several advantages, for example, that evidence for the null hypothesis of conditional independence is formally evaluated. As a result, the <code>explore</code> method in <strong>BGGMmod</strong> provides plots for both the conditional dependence and independence structure, in addition to a plot for which the evidence was ambiguous.</p>
<p>To highlight this advantage, <code>ptsd</code> data is used that has a relatively small sample size.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># fit model</span>
<span class="no">fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/explore.html">explore</a></span>(<span class="no">Y</span>)

<span class="no">E</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/select.html">select</a></span>(<span class="no">fit</span>, <span class="kw">BF_cut</span> <span class="kw">=</span> <span class="fl">3</span>)</pre></body></html></div>
<p>Then plot the results. Note that there are three plots, so the package <strong>cowplot</strong> is used to combine them into one plot.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">plts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">E</span>,
             <span class="kw">edge_magnify</span> <span class="kw">=</span> <span class="fl">5</span>,
             <span class="kw">groups</span> <span class="kw">=</span> <span class="no">comm</span>)

<span class="fu"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(
<span class="no">plts</span>$<span class="no">H1_plt</span> +
  <span class="fu">ggtitle</span>(<span class="st">"Conditional Dependence"</span>) +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span>  <span class="st">"none"</span>),

<span class="no">plts</span>$<span class="no">H0_plt</span> +
  <span class="fu">ggtitle</span>(<span class="st">"Conditional Independence"</span>) +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span>  <span class="st">"none"</span>),
<span class="no">plts</span>$<span class="no">ambiguous_plt</span> +
  <span class="fu">ggtitle</span>(<span class="st">"Ambiguous"</span>),
<span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">1</span>,
<span class="kw">rel_widths</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1.1</span>)
)</pre></body></html></div>
<p><img src="../man/figures/hyp_plot.png"></p>
<p>As can be seen, there is not evidence for conditional independence for any of the relations. And the ambiguous network makes clear there is large uncertainty as to what or what might not be the “true” network structure. This basic idea of having three adjacency matrices was proposed in <span class="citation">Williams and Mulder (2019)</span>.</p>
</div>
<div id="note" class="section level1">
<h1 class="hasAnchor">
<a href="#note" class="anchor"></a>Note</h1>
<p><strong>BGGMmod</strong> provides a publication ready plot, but it is also limited compared to <strong>qgraph</strong> <span class="citation">(Epskamp et al. 2012)</span>. The one advantage of <strong>BGGMmod</strong> is that all plots are <code>ggplots</code> which then allows for combining them rather easily. An example is included in another vignette that shows how to combine several plots made with various methods in <strong>BGGMmod</strong></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-epskamp2012qgraph">
<p>Epskamp, Sacha, Angélique OJ Cramer, Lourens J Waldorp, Verena D Schmittmann, Denny Borsboom, and others. 2012. “Qgraph: Network Visualizations of Relationships in Psychometric Data.” <em>Journal of Statistical Software</em> 48 (4): 1–18.</p>
</div>
<div id="ref-Williams2019_bf">
<p>Williams, Donald R, and Joris Mulder. 2019. “Bayesian Hypothesis Testing for Gaussian Graphical Models: Conditional Independence and Order Constraints.” <em>PsyArXiv</em>. <a href="https://doi.org/10.31234/osf.io/ypxd8">https://doi.org/10.31234/osf.io/ypxd8</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Donald Williams, Joris Mulder.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
